<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SERA-X - Submitted Constructs</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <a class="skip-link" href="#main">Skip to main content</a>
    <header>
        <h1><a class="logo" href="index.html">SERA-X</a></h1>
        <button class="nav-toggle" aria-label="Toggle navigation">&#9776;</button>
        <nav class="site-nav" aria-label="Primary">
            <ul>
                <li><a href="sense.html">Sense</a></li>
                <li><a href="explain.html">Explain</a></li>
                <li><a href="respond.html">Respond</a></li>
                <li><a href="adapt.html">Adapt</a></li>
                <li><a href="extended.html">Extended</a></li>
            </ul>
        </nav>
    </header>
    <main id="main">
        <section id="constructs">
            <h2>Submitted Constructs</h2>
            <p>Community submissions collected from GitHub issues.</p>
            <div class="sort-controls">
                <label for="sort-select">Sort by:</label>
                <select id="sort-select">
                    <option value="date">Date</option>
                    <option value="title">Alphabetical</option>
                    <option value="field">Field/Topic</option>
                    <option value="axis">SERA-X Axis</option>
                </select>
            </div>
            <table id="construct-table">
                <thead>
                    <tr>
                        <th>Construct</th>
                        <th>User</th>
                        <th>Date</th>
                        <th>Axes</th>
                        <th>Fields</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <p>Click a title to open the original issue and share feedback.</p>
        </section>
    </main>
    <footer>
        <p>&copy; SERA-X contributors</p>
    </footer>
    <script>
    function parseMeta(c) {
        const body = (c.body || '').toLowerCase();
        const axes = ['sense','explain','respond','adapt','extended'];
        const foundAxes = axes.filter(a => body.includes(a));
        c.axis = foundAxes.join(', ');
        const fields = ['psychology','philosophy','neuroscience'];
        const foundFields = fields.filter(f => body.includes(f));
        c.field = foundFields.length ? foundFields.join(', ') : 'other';
    }

    function render(data) {
        const tbody = document.querySelector('#construct-table tbody');
        tbody.innerHTML = '';
        data.forEach(c => {
            const row = document.createElement('tr');
            const date = new Date(c.created_at);
            const md = date.toLocaleDateString(undefined, { month: 'short', day: 'numeric' });
            row.innerHTML = `
                <td><a href="${c.url}">${c.title}</a></td>
                <td>${c.user}</td>
                <td>${md}</td>
                <td>${c.axis}</td>
                <td>${c.field}</td>`;
            tbody.appendChild(row);
        });
    }

    fetch('construct_submissions.json')
        .then(r => r.json())
        .then(data => {
            data.forEach(parseMeta);
            render(data);
            document.getElementById('sort-select').addEventListener('change', e => {
                const v = e.target.value;
                if (v === 'title') data.sort((a,b)=>a.title.localeCompare(b.title));
                else if (v === 'field') data.sort((a,b)=>a.field.localeCompare(b.field));
                else if (v === 'axis') data.sort((a,b)=>a.axis.localeCompare(b.axis));
                else data.sort((a,b)=>new Date(a.created_at)-new Date(b.created_at));
                render(data);
            });
        });
    </script>
    <script src="script.js"></script>
</body>
</html>
